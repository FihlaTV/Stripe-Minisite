<h1>tap-stream <a href="http://travis-ci.org/thlorenz/tap-stream"><img src="https://secure.travis-ci.org/thlorenz/tap-stream.png" alt="Build Status" /></a></h1>

<p>Taps a nodejs stream and logs the data that&#8217;s coming through.</p>

<pre><code>npm install tap-stream
</code></pre>

<p>Given an <a href="#object-stream">object stream</a> we can print out objects passing through and control the detail via the
depth parameter:</p>

<p><code>javascript
objectStream().pipe(tap(0));
</code></p>

<p><img src="https://github.com/thlorenz/tap-stream/raw/master/assets/depth0.png" alt="depth0" /></p>

<p><code>javascript
objectStream().pipe(tap(1));
</code></p>

<p><img src="https://github.com/thlorenz/tap-stream/raw/master/assets/depth1.png" alt="depth1" /></p>

<p><code>
objectStream().pipe(tap(2));
</code></p>

<p><img src="https://github.com/thlorenz/tap-stream/raw/master/assets/depth2.png" alt="depth2" /></p>

<p>For even more control a custom log function may be supplied:</p>

<p><code>javascript
objectStream()
  .pipe(tap(function customLog (data) {
      var nest = data.nest;
      console.log ('Bird: %s, id: %s, age: %s, layed egg: %s', nest.name, data.id, nest.age, nest.egg !== undefined);
    })
  );
</code></p>

<p><code>text
Bird: yellow rumped warbler, id: 0, age: 1, layed egg: true
Bird: yellow rumped warbler, id: 1, age: 1, layed egg: true
</code></p>

<h2>API</h2>

<h3>tap( [ depth | log ] )</h3>

<p>Intercepts the stream and logs data that is passing through.</p>

<ul>
  <li>optional parameter is either a <code>Number</code> or a <code>Function</code></li>
  <li>
    <p>if no parameter is given, <code>depth</code> defaults to <code>0</code> and <code>log</code> to <code>console.log(util.inspect(..))</code></p>
  </li>
  <li><code>depth</code> controls the <code>depth</code> with which
<a href="http://nodejs.org/api/util.html#util_util_inspect_object_showhidden_depth_colors">util.inspect</a> is called</li>
  <li><code>log</code> replaces the default logging function with a custom one</li>
</ul>

<p><strong>Example:</strong></p>

<p>```javascript
var tap = require(&#8216;tap-stream&#8217;);</p>

<p>myStream
  .pipe(tap(1)) // log intermediate results
  .pipe(..)     // continute manipulating the data
```</p>

<h2>Object stream</h2>

<p>Included in order to give context for above examples.</p>

<p>```javascript
function objectStream () {
  var s = new Stream()
    , objects = 0;</p>

<p>var iv = setInterval(
      function () {
        s.emit(&#8216;data&#8217;, { 
            id: objects
          , created: new Date()
          , nest: { 
                name: &#8216;yellow rumped warbler&#8217;
              , age: 1
              , egg: { name: &#8216;unknown&#8217; , age: 0 }
              } 
          }
        , 4
        );</p>

<pre><code>    if (++objects === 2) {
        s.emit('end');
        clearInterval(iv);
    }
  }
, 200);   return s; } ```
</code></pre>
